<header class="site-header">
  <a class="skip-link" href="#main">Skip to content</a>

  <!-- BRAND + ACCOUNT (TOP ROW) -->
  <div class="brand-row">
    <p class="brand">CSE <span>340</span></p>

    <!-- ACCOUNT DROPDOWN -->
    <div class="account-menu">
      <button
        class="account-link account-toggle"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
      >
        <i class="fas fa-user-circle" aria-hidden="true"></i>
        <span>My Account</span>
        <i class="fas fa-chevron-down caret" aria-hidden="true"></i>
      </button>

      <ul class="account-dropdown" aria-label="Account options">
        <li><a href="/account/login">Login</a></li>
        <li><a href="/account/register">Sign-up</a></li>
      </ul>
    </div>
  </div>

  <!-- MAIN NAV BAR -->
  <nav class="main-nav" aria-label="Main navigation">
    <ul class="nav-list">

      <% 
        const links = [
          { href: '/',        label: 'Home',     match: 'CSE Motors' },
          { href: '/custom',  label: 'Custom Shop (All Vehicles)', match: 'Custom' },
          { href: '/sport',   label: 'Sport Cars', match: 'Sport' },
          { href: '/suv',     label: 'SUVs',      match: 'SUV' },
          { href: '/sedan',   label: 'Sedans',    match: 'Sedan' },
          { href: '/truck',   label: 'Trucks',    match: 'Truck' }
        ];
      %>

      <% links.forEach(link => { %>
        <li>
          <a href="<%= link.href %>"
             <%= title && title.startsWith(link.match) ? 'class="current-page" aria-current="page"' : '' %>>
            <%= link.label %>
          </a>
        </li>
      <% }) %>

    </ul>
  </nav>
</header>

<!-- SINGLE CLEAN SCRIPT HANDLING ONLY My Account DROPDOWN -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ===== My Account dropdown ===== */
  const accountMenu = document.querySelector(".account-menu");
  const accountToggle = accountMenu?.querySelector(".account-toggle");

  if (accountMenu && accountToggle) {
    accountToggle.addEventListener("click", e => {
      e.stopPropagation();
      const expanded = accountToggle.getAttribute("aria-expanded") === "true";
      const newState = !expanded;

      accountToggle.setAttribute("aria-expanded", String(newState));
      accountMenu.classList.toggle("open", newState);
    });
  }

  /* ===== Global click to close dropdown ===== */
  document.addEventListener("click", () => {
    if (accountMenu && accountToggle) {
      accountMenu.classList.remove("open");
      accountToggle.setAttribute("aria-expanded", "false");
    }
  });

});
</script>
